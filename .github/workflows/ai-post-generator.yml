name: AI Post Generator
on:
  schedule:
    - cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  generate:
    runs-on: ubuntu-latest
    permissions: { issues: write }
    steps:
      - uses: actions/setup-python@v4
        with: { python-version: '3.11' }

      - name: Generate text
        id: gen
        run: |
          THEMES=("新規事業" "マーケ施策" "プロダクト改善")
          THEME=${THEMES[$RANDOM % 3]}
          TITLE="企画×AI活用（${THEME}）：$(date +%Y%m%d)"
          BODY="【中級者向け・${THEME}×AI活用】\n\n企画業務では、AIを情報整理と選択肢生成に使うと効果的です。発散と収束を分け、評価軸を先に定義することで、企画の質とスピードが向上します。"
          echo "title=$TITLE" >> $GITHUB_OUTPUT
          echo "theme=$THEME" >> $GITHUB_OUTPUT
          echo "body<<EOF" >> $GITHUB_OUTPUT
          echo "$BODY" >> $GITHUB_OUTPUT
          echo "EOF" >> $GITHUB_OUTPUT

      - name: Create Issue
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: "${{ steps.gen.outputs.title }}",
              body: "${{ steps.gen.outputs.body }}",
              labels: ["AI","企画","${{ steps.gen.outputs.theme }}"]
            })
